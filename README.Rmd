---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# legistarapi

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
<!-- badges: end -->

The goal of legistarapi is to allow access to the [Legistar Web API](https://webapi.legistar.com/). [Legistar](https://granicus.com/solution/govmeetings/legistar/) is "agenda and legislative management software for large municipalities and counties" supplied by Granicus. According to [promotional material](https://granicus.com/pdfs/product_legistar.pdf), Legistar is used by 70% of the largest cities and counties in the U.S.

## Installation

You can install the development version of legistarapi like so:

``` r
# pak::pkg_install("elipousson/legistarapi")
```

## Example

```{r setup}
library(legistarapi)
```

Get persons using `legistar()`:

```{r persons}
legistar(template = "persons", client = "seattle", top = 10)
```

Or using the dedicated `legistar_get_persons()` function:

```{r bodies}
legistar_get_persons(client = "seattle", top = 10)
```

The Legistar Web API has at least partial support for the [OData Version 3.0](https://www.odata.org/documentation/odata-version-3-0/odata-version-3-0-core-protocol/) URL conventions. Support for these conventions is incomplete but the `top` and `orderby` query parameters are available:

```{r}
legistar(
  client = "baltimore",
  template = "events",
  top = 10,
  orderby = "EventDate"
)
```

Specific usage may vary by jurisdiction. One starting place is listing the Matter Types for a Legistar client site:

```{r}
matter_types <- legistar(
  client = "baltimore",
  template = "matter_types"
)

str(matter_types)
```

For Baltimore City, the "Ordinance" Matter Type has a ID value of 1. We can use the filter parameter to return a data frame of ordinances:

```{r}
ordinances <- legistar(
  client = "baltimore",
  template = "matters",
  top = 10,
  filter = "MatterTypeId eq 1"
)

str(ordinances)
```

## Related projects

- [Python Legistar Scraper](https://github.com/opencivicdata/python-legistar-scraper)
- [scrapers-us-municipal](https://github.com/opencivicdata/scrapers-us-municipal) (Scrapers for US municipal governments)
- [Council Data Project](https://councildataproject.org/)
- [cdp-scrapers](https://councildataproject.org/cdp-scrapers/index.html) (Scratchpad for scraper development and general utilities for the Council Data Project)
